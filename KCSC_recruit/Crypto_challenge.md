# Crypto challenge

## Table of contents:
* [Đề 1: Tet is ya best](#Đề-1-tet-is-ya-best)
* [Đề 2: Ezenc](#Đề-2-ezenc)
* [Đề 3: Chuyến tàu vô tận ](#Đề-3-chuyến-tàu-vô-tận)
* [Đề 4: Waiting for you](#Đề-4-waiting-for-you)

## Đề 1: Tet is ya best
```
Tết cổ truyền luôn là ngày lễ quan trọng của Việt Nam. Năm nay, nhân dịp Tết đến xuân về, Lulu đã viết một lời chúc gửi đến tất cả các thành viên đã, đang và sẽ trở thành một phần không thể thiếu của KCSC. Các bạn hãy tìm lời chúc của Lulu nhá :)
```

Nội dung file: 

```
lyl, rwns dmsfm rn wkmrx myf iyrx pynljorw, jn luy ejvvynl lxrqjljsmrw pynljorw jm ojyl mrh.
lyl jn knkrwwi pxsh luy ymq sp trmkrxi ls yrxwi pyexkrxi. 
eypsxy lyl, ojylmrhyny cxycrxy hrmi lujmvn psx luy luxyy hrjm qrin. 
luyi gwyrm luyjx uskny rmq qygsxrly fjlu pwsfyxn nkgu rn dkhbkrl lxyy sx cyrgu ewsnnsh. 
r ukvy rhskml sp pssq fjww ey eskvul eypsxy lyl psx hrdjmv lxrqjljsmrw qjnuyn. ermu gukmv, ermu lyl, vjs gur, asj rmq hkl, …rmq grmqjyn rxy luy pssqn lurl hknl uroy sm lyl uswjqrin.
qkxjmv lyl, cyscwy ojnjl luyjx xywrljoyn’ ushyn rmq vjoy fjnuyn. 
usfyoyx, luy ojylmrhyny eywjyoy lurl luy pjxnl ojnjlsx r prhjwi xygyjoyn jm luy iyrx qylyxhjmyn luyjx psxlkmy psx luy ymljxy iyrx, cyscwy myoyx ymlyx rmi uskny sm luy pjxnl qri fjluskl eyjmv jmojlyq pjxnl. 
rmsluyx gknlsh jn vjojmv wkgdi hsmyi, fujgu jn ckl jmls r xyq ymoywscy rn r nihesw sp wkgd rmq fjnu psx r myf rvy. 
lxrqjljsmrwwi, ywqyxn fjww vjoy wkgdi hsmyi ls gujwqxym rmq luy swqynl cyscwy jm luy prhjwi. usfyoyx, msfrqrin, cyscwy grm vjoy jl ls rmismy jmgwkqjmv pxjymqn, crxymln, myjvuesxn,… 
eynjqyn, ojylmrhyny knkrwwi vs ls crvsqrn sx lyhcwyn ls cxri psx uyrwlu, fyrwlu, nkggynn,… 
ls ojylmrhyny, lyl jn luy urccjynl ljhy sp rww iyrx rxskmq, hyheyxn jm r prhjwi grm vrluyx lsvyluyx, fujgu jn r hyrmjmvpkw hynnrvyn sp wkmrx myf iyrx pynljorw. 
rww jm rww, lyl jn rww reskl ergd ls sxjvjmn, ey vssq ls sluyxn, ymtsi luy cxygjskn hshyml, rmq fjnu psx luy eynl ls gshy.
luy pwrv jn: dgng{lyl_lyl_lyl_lyl_qym_xsj__gukg_grg_erm_mrh_hsj_lurl_mujyk_nkg_dusy__wko_pxsh_wkwkkkkkkkkkkkk}

```
#### Đây là mật mã thay thế, dùng tool quipquiup để phân tích:
#### Tool: [quipquiup](https://quipqiup.com/)

tet, also known as lunar new year festival, is the biggest traditional festival in viet nam. tet is usually from the end of january to early february. before tet, vietnamese prepare many things for the three main days. they clean their house and decorate with flowers such as kumquat tree or peach blossom. a huge amount of food will be bought before tet for making traditional dishes. banh chung, banh tet, gio cha, zoi and mut, …and candies are the foods that must have on tet holidays. during tet, people visit their relatives’ homes and give wishes. however, the vietnamese believe that the first visitor a family receives in the year determines their fortune for the entire year, people never enter any house on the first day without being invited first. another custom is giving lucky money, which is put into a red envelope as a symbol of luck and wish for a new age. traditionally, elders will give lucky money to children and the oldest people in the family. however, nowadays, people can give it to anyone including friends, parents, neighbors,… besides, vietnamese usually go to pagodas or temples to pray for health, wealth, success,… to vietnamese, tet is the happiest time of all year around, members in a family can gather together, which is a meaningful messages of lunar new year festival. all in all, tet is all about back to origins, be good to others, enjoy the precious moment, and wish for the best to come. the flag is: kcsc{tet_tet_tet_tet_den_roi__chuc_cac_ban_nam_moi_that_nhieu_suc_khoe__luv_from_luluuuuuuuuuuuu}



>flag: kcsc{tet_tet_tet_tet_den_roi__chuc_cac_ban_nam_moi_that_nhieu_suc_khoe__luv_from_luluuuuuuuuuuuu}

## Đề 2: Ezenc

### [chal.txt](https://github.com/manhhuy2002/hello-world/blob/main/chal.txt)

Nội dung file chal:

```
4e544d7a4d44526c4e5451314d544d7a4e7a51304e6a59794e6d51305a5463324e5745304e7a5a6a4e7a553159544d784d7a6b305954597a4d7a457a4f5451304e6a497a4d6a4d354e7a4d304f54557a4e4455324f4459324e54457a5a444e6b

```

Đoạn mã đang ở dạng hex, dùng cyberchef decode được dạng base 64, decode tiếp được dạng hex, decode tiếp base64 được flag:

![alt-text](https://github.com/manhhuy2002/hello-world/blob/main/enzc.jpg)

>flag: KCSC{Encoding_Is_Cool!!!}


## Đề 3: Chuyến tàu vô tận

```
Trước giờ tàu lăn bánh, Hashibira Inosuke có nhặt được một bức thư được mã hóa trên đường ray. Bản năng mách bảo đây là một thông điệp cực kỳ quan trọng,
nhưng hắn không sao giải được. Các bạn hãy giúp Inosuke giải mã thông điệp này.

```

[message.txt](https://bcm.kcslab.asia/files/6c8821149270512d8eec40e2d3925230/message.txt?token=eyJ1c2VyX2lkIjo0MiwidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6MjF9.Y9Nz6A.d-gjurlsGleWTM0P6EwuUOZsWX8)

Nội dung file message:
```
01010011 00110001 01000010 01010100 01010110 01101011 00110101 01010110 01010011 01101011 01001010 01010011 01010101 00110000 01000110 01001111 01010001 00110000 01001110 01001101 01010001 01010101 01010110 01000010 01010010 01010101 01010110 01001000 01010011 00110000 01110100 01010000 01010110 01010101 00111001 01000110 01010100 00110000 01010110 01000010 01010110 01000110 01010010 01010101 01010100 00110001 01001110 01000110 01010101 00110001 01001010 01010000 01010111 01010110 01001010 01000111 01010100 01000110 01001110 01001010
```
Nội dung file đang ở dạng binary, decode được: 

```
KPSVNUJBRSANCCLAEAEEGKKOUOEOEATTTOSESROYRFLSI
```
Dựa vào hint tên đề, đây là mật mã rail fence, đưa lên cyberchef decode:

![image](https://github.com/manhhuy2002/hello-world/blob/main/train.jpg)



>flag: KCSC{PLEASESAVERENGOKUKYOJUROBEFORELASTSTATION}

## Đề 4: Waiting for you

```
ú oà
```

[chal.py](https://bcm.kcslab.asia/files/2ccbf8d07cb891d9189ada78c3d57996/chal.py?token=eyJ1c2VyX2lkIjo0MiwidGVhbV9pZCI6bnVsbCwiZmlsZV9pZCI6NDd9.Y9N5Qg.ntzXVKodHBFaD3FsPXIwArvIblY)

Source code: 

```

def xor(a: bytes, b: bytes):
    return bytes([a[i % len(a)] ^ b[i % len(b)] for i in range(max(len(a), len(b)))])


flag = b"KCSC{???????????????????????????}"
key = b"??????"
print(xor(flag, key))
#b'>0\x0c,\x1a+:=\x100(5*,\x08*(2<=\x11!> E!\x006Q3VP"'

```
Đoạn code thực hiện xor từng byte của flag và key rồi trả về giá trị mới trong đó mỗi byte là kết quả so sánh các byte tương ứng của flag và key.
Thực hiện xor được: 

```
b'us_oa\x14\x05\x02/\x0f\x17\n\x15\x137\x15\x17\r\x03\x02.\x1e\x01\x1fz\x1e?\tn\x0cio_'

```
Đề bài hint ú òa, key = b"us_oaf"

Thực hiện xor giữa key và binary: 

```
def xor(a: bytes, b: bytes):
    return bytes([a[i % len(a)] ^ b[i % len(b)] for i in range(max(len(a), len(b)))])


flag = b"KCSC{???????????????????????????}"
key = b"us_oaf"

binary = b'>0\x0c,\x1a+:=\x100(5*,\x08*(2<=\x11!> E!\x006Q3VP"'

print(xor(binary, key))

```
Kết quả trả về: b'KCSC{MONO_IS__WEITINNN_F0R_Y0U##}'

>flag: KCSC{MONO_IS__WEITINNN_F0R_Y0U##}


